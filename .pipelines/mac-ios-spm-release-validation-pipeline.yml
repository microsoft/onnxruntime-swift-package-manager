  jobs:
  - job: j
    displayName: "Test with released ORT native pod"

    pool:
      vmImage: "macOS-13"

    variables:
      xcodeVersion: "14.3"

    timeoutInMinutes: 60

    steps:
    - template: templates/use-xcode-version.yml
      parameters:
        xcodeVersion: ${{ variables.xcodeVersion }}

    # Note: Running xcodebuild test on `onnxruntime-Package` scheme will perform swift tests for both OnnxRuntimeBindings
    # and OnnxRuntimeExtensions targets.
    - script: |
        set -e -x
        xcodebuild test -scheme onnxruntime-Package -destination 'platform=iOS Simulator,name=iPhone 14'
      workingDirectory: "$(Build.SourcesDirectory)"
      displayName: "Test Package.swift usage"

    - template: templates/component-governance-component-detection-steps.yml
      parameters:
        condition: 'succeeded'